on: push

env:
  tenant: hmctsdevextid.onmicrosoft.com
  clientId: b67b538e-1ceb-4e5e-a0a9-8e8d16618e97

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: 'Upload B2C Custom Policies'
        uses: azure-ad-b2c/deploy-trustframework-policy@v3
        with:
          folder: './b2c/custom_policies'
          files: 'TrustFrameworkBase.xml,TrustFrameworkLocalization.xml,TrustFrameworkExtensions.xml,SignUpOrSignin.xml,ProfileEdit.xml,PasswordReset.xml'
          tenant: ${{ env.tenant }}
          clientId: ${{ env.clientId }}
          clientSecret: ${{ secrets.PRE_MANAGEMENT_APP }}
