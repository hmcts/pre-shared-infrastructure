on: push

env:
  tenant: hmctsdevextid.onmicrosoft.com

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: 'Upload B2C Custom Policies'
        uses: azure-ad-b2c/deploy-trustframework-policy@v3
        with:
          folder: './b2c/custom_policies'
          files: 'TrustFrameworkBase.xml,TrustFrameworkLocalization.xml,TrustFrameworkExtensions.xml,SignUpOrSignIn.xml,ProfileEdit.xml,PasswordReset.xml'
          tenant: ${{ env.tenant }}
          clientId: ${{ secrets.PRE_MANAGEMENT_APP_CLIENT_ID }}
          clientSecret: ${{ secrets.PRE_MANAGEMENT_APP }}
